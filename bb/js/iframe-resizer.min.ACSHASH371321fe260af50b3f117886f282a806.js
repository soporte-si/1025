/*
 iFrame Resizer (iframeSizer.min.js ) - v3.5.14 - 2017-03-30
  Desc: Force cross domain iframes to size to content.
  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
  Copyright: (c) 2017 David J. Bradshaw - dave@bradshaw.net
  License: MIT
*/
!function(t){function q(a,b,d){"addEventListener"in window?a.addEventListener(b,d,!1):"attachEvent"in window&&a.attachEvent("on"+b,d)}function T(a,b,d){"removeEventListener"in window?a.removeEventListener(b,d,!1):"detachEvent"in window&&a.detachEvent("on"+b,d)}function U(){var a,b=["moz","webkit","o","ms"];for(a=0;a<b.length&&!n;a+=1)n=window[b[a]+"RequestAnimationFrame"];n||h("setup","RequestAnimationFrame not supported")}function V(a){var b="Host page: "+a;return window.top!==window.self&&(b=window.parentIFrame&&
window.parentIFrame.getId?window.parentIFrame.getId()+": "+a:"Nested host page: "+a),b}function h(a,c){A("log",a,c,b[a]?b[a].log:B)}function r(a,b){A("warn",a,b,!0)}function A(a,b,d,e){!0===e&&"object"==typeof window.console&&console[a](C+"["+V(b)+"]",d)}function W(a){function c(){e("Height");e("Width");H(function(){I(k);J(f);w(f,"resizedCallback",k)},k,"init")}function d(){var a=m.substr(F).split(":");return{iframe:b[a[0]].iframe,id:a[0],height:a[1],width:a[2],type:a[3]}}function e(a){var e=Number(b[f]["max"+
a]),d=Number(b[f]["min"+a]);a=a.toLowerCase();var c=Number(k[a]);h(f,"Checking "+a+" is in range "+d+"-"+e);d>c&&(c=d,h(f,"Set "+a+" to min value"));c>e&&(c=e,h(f,"Set "+a+" to max value"));k[a]=""+c}function G(){function e(){function a(){var a=0,b=!1;for(h(f,"Checking connection is from allowed list of origins: "+c);a<c.length;a++)if(c[a]===d){b=!0;break}return b}function e(){var a=b[f].remoteHost;return h(f,"Checking connection is from: "+a),d===a}return c.constructor===Array?a():e()}var d=a.origin,
c=b[f].checkOrigin;if(c&&"null"!=""+d&&!e())throw Error("Unexpected message received from: "+d+" for "+k.iframe.id+". Message was: "+a.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function t(){var a=k.type in{"true":1,"false":1,undefined:1};return a&&h(f,"Ignoring init message from meta parent page"),a}function g(a){h(f,"MessageCallback passed: {iframe: "+k.iframe.id+", message: "+a+"}");a={iframe:k.iframe,message:JSON.parse(a)};
w(f,"messageCallback",a);h(f,"--")}function x(a,b){D(function(){var e=p;var c=document.body.getBoundingClientRect();var d=k.iframe.getBoundingClientRect();c=JSON.stringify({iframeHeight:d.height,iframeWidth:d.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(d.top-c.top,10),offsetLeft:parseInt(d.left-c.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset});
e("Send Page Info","pageInfo:"+c,a,b)},32)}function X(){function a(a,d){function f(){b[c]?x(b[c].iframe,c):e()}["scroll","resize"].forEach(function(b){h(c,a+b+" listener for sendPageInfo");d(window,b,f)})}function e(){a("Remove ",T)}var c=f;a("Add ",q);b[c].stopPageInfo=e}function Y(){var a=!0;return null===k.iframe&&(r(f,"IFrame ("+k.id+") not found"),a=!1),a}function n(a){a=a.getBoundingClientRect();return K(f),{x:Math.floor(Number(a.left)+Number(l.x)),y:Math.floor(Number(a.top)+Number(l.y))}}function u(a){var b=
a?n(k.iframe):{x:0,y:0},c={x:Number(k.width)+b.x,y:Number(k.height)+b.y};h(f,"Reposition requested from iFrame (offset x:"+b.x+" y:"+b.y+")");window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(a?"Offset":"")](c.x,c.y):r(f,"Unable to scroll to requested position, window.parentIFrame not found"):(l=c,v(),h(f,"--"))}function v(){!1!==w(f,"scrollCallback",l)?J(f):l=null}function y(a){a=a.split("#")[1]||"";var b=decodeURIComponent(a);(b=document.getElementById(b)||document.getElementsByName(b)[0])?
(b=n(b),h(f,"Moving to in page link (#"+a+") at x: "+b.x+" y: "+b.y),l={x:b.x,y:b.y},v(),h(f,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(a):h(f,"In page link #"+a+" not found and window.parentIFrame not found"):h(f,"In page link #"+a+" not found")}function z(a){var c=!0;return b[a]||(c=!1,r(k.type+" No settings for "+a+". Message was: "+m)),c}function E(){for(var a in b)p("iFrame requested init",L(a),document.getElementById(a),a)}var m=a.data,k={},f=null;if("[iFrameResizerChild]Ready"===
m)E();else if(C===(""+m).substr(0,F)&&m.substr(F).split(":")[0]in b){if(k=d(),f=k.id,b[f].loaded=!0,!t()&&z(f)&&(h(f,"Received: "+m),Y()&&G()))switch(b[f].firstRun&&(b[f].firstRun=!1),k.type){case "close":M(k.iframe);break;case "message":g(m.substr(m.indexOf(":")+N+6));break;case "scrollTo":u(!1);break;case "scrollToOffset":u(!0);break;case "pageInfo":x(b[f].iframe,f);X();break;case "pageInfoStop":b[f]&&b[f].stopPageInfo&&(b[f].stopPageInfo(),delete b[f].stopPageInfo);break;case "inPageLink":y(m.substr(m.indexOf(":")+
N+9));break;case "reset":O(k);break;case "init":c();w(f,"initCallback",k.iframe);break;default:c()}}else A("info",f,"Ignored: "+m,b[f]?b[f].log:B)}function w(a,c,d){var e=null,h=null;if(b[a]){if(e=b[a][c],"function"!=typeof e)throw new TypeError(c+" on iFrame["+a+"] is not a function");h=e(d)}return h}function M(a){var c=a.id;h(c,"Removing iFrame: "+c);a.parentNode&&a.parentNode.removeChild(a);w(c,"closedCallback",c);h(c,"--");delete b[c]}function K(a){null===l&&(l={x:window.pageXOffset!==t?window.pageXOffset:
document.documentElement.scrollLeft,y:window.pageYOffset!==t?window.pageYOffset:document.documentElement.scrollTop},h(a,"Get page position: "+l.x+","+l.y))}function J(a){null!==l&&(window.scrollTo(l.x,l.y),h(a,"Set page position: "+l.x+","+l.y),l=null)}function O(a){h(a.id,"Size reset requested by "+("init"===a.type?"host page":"iFrame"));K(a.id);H(function(){I(a);p("reset","reset",a.iframe,a.id)},a,"reset")}function I(a){function c(b){a.iframe.style[b]=a[b]+"px";h(a.id,"IFrame ("+d+") "+b+" set to "+
a[b]+"px");E||"0"!==a[b]||(E=!0,h(d,"Hidden iFrame detected, creating visibility listener"),Z())}var d=a.iframe.id;b[d]&&(b[d].sizeHeight&&c("height"),b[d].sizeWidth&&c("width"))}function H(a,b,d){d!==b.type&&n?(h(b.id,"Requesting animation frame"),n(a)):a()}function p(a,c,d,e,l){function G(){var g=b[e].targetOrigin;h(e,"["+a+"] Sending msg to iframe["+e+"] ("+c+") targetOrigin: "+g);d.contentWindow.postMessage(C+c,g)}function g(){function a(){!b[e]||b[e].loaded||x||(x=!0,r(e,"IFrame has not responded within "+
b[e].warningTimeout/1E3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}l&&b[e].warningTimeout&&(b[e].msgTimeout=setTimeout(a,b[e].warningTimeout))}var x=!1;e=e||d.id;b[e]&&(d&&"contentWindow"in d&&null!==d.contentWindow?G():r(e,"["+a+"] IFrame("+e+") not found"),g())}function L(a){return a+":"+b[a].bodyMarginV1+":"+b[a].sizeWidth+
":"+b[a].log+":"+b[a].interval+":"+b[a].enablePublicMethods+":"+b[a].autoResize+":"+b[a].bodyMargin+":"+b[a].heightCalculationMethod+":"+b[a].bodyBackground+":"+b[a].bodyPadding+":"+b[a].tolerance+":"+b[a].inPageLinks+":"+b[a].resizeFrom+":"+b[a].widthCalculationMethod}function P(a,c){function d(){function c(c){1/0!==b[g][c]&&0!==b[g][c]&&(a.style[c]=b[g][c]+"px",h(g,"Set "+c+" \x3d "+b[g][c]+"px"))}function d(a){if(b[g]["min"+a]>b[g]["max"+a])throw Error("Value for min"+a+" can not be greater than max"+
a);}d("Height");d("Width");c("maxHeight");c("minHeight");c("maxWidth");c("minWidth")}function e(){Function.prototype.bind&&(b[g].iframe.iFrameResizer={close:M.bind(null,b[g].iframe),resize:p.bind(null,"Window resize","resize",b[g].iframe),moveToAnchor:function(a){p("Move to anchor","moveToAnchor:"+a,b[g].iframe,g)},sendMessage:function(a){a=JSON.stringify(a);p("Send Message","message:"+a,b[g].iframe,g)}})}function l(c){q(a,"load",function(){p("iFrame.onload",c,a,t,!0);var d=b[g].heightCalculationMethod in
aa;!b[g].firstRun&&d&&O({iframe:a,height:0,width:0,type:"init"})});p("init",c,a,t,!0)}function n(c){c=c||{};b[g]={firstRun:!0,iframe:a,remoteHost:a.src.split("/").slice(0,3).join("/")};if("object"!=typeof c)throw new TypeError("Options is not an object");for(var d in u)u.hasOwnProperty(d)&&(b[g][d]=c.hasOwnProperty(d)?c[d]:u[d]);d=b[g];!0===b[g].checkOrigin?(c=b[g].remoteHost,c=""===c||"file://"===c?"*":c):c="*";d.targetOrigin=c}var g=function(b){if(""===b){var d=c&&c.id||u.id+Q++;b=(null!==document.getElementById(d)&&
(d+=Q++),d);a.id=b;B=(c||{}).log;h(b,"Added missing iframe ID: "+b+" ("+a.src+")")}return b}(a.id);if(g in b&&"iFrameResizer"in a)r(g,"Ignored iFrame, already setup.");else{n(c);switch(h(g,"IFrame scrolling "+(b[g].scrolling?"enabled":"disabled")+" for "+g),a.style.overflow=!1===b[g].scrolling?"hidden":"auto",b[g].scrolling){case !0:a.scrolling="yes";break;case !1:a.scrolling="no";break;default:a.scrolling=b[g].scrolling}d();("number"==typeof b[g].bodyMargin||"0"===b[g].bodyMargin)&&(b[g].bodyMarginV1=
b[g].bodyMargin,b[g].bodyMargin=""+b[g].bodyMargin+"px");l(L(g));e()}}function D(a,b){null===v&&(v=setTimeout(function(){v=null;a()},b))}function Z(){function a(){for(var a in b)null===b[a].iframe.offsetParent||"0px"!==b[a].iframe.style.height&&"0px"!==b[a].iframe.style.width||p("Visibility change","resize",b[a].iframe,a)}function c(b){h("window","Mutation observed: "+b[0].target+" "+b[0].type);D(a,16)}function d(){var a=document.querySelector("body");(new e(c)).observe(a,{attributes:!0,attributeOldValue:!1,
characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0})}var e=window.MutationObserver||window.WebKitMutationObserver;e&&d()}function y(a){h("window","Trigger event: "+a);D(function(){R("Window "+a,"resize")},16)}function S(){function a(){R("Tab Visable","resize")}"hidden"!==document.visibilityState&&(h("document","Trigger event: Visiblity change"),D(a,16))}function R(a,c){for(var d in b)"parent"===b[d].resizeFrom&&b[d].autoResize&&!b[d].firstRun&&p(a,c,document.getElementById(d),d)}function ba(){q(window,
"message",W);q(window,"resize",function(){y("resize")});q(document,"visibilitychange",S);q(document,"-webkit-visibilitychange",S);q(window,"focusin",function(){y("focus")});q(window,"focus",function(){y("focus")})}function z(){function a(a,c){if(c){if(!c.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==c.tagName.toUpperCase())throw new TypeError("Expected \x3cIFRAME\x3e tag, found \x3c"+c.tagName+"\x3e");P(c,a);b.push(c)}}var b;return U(),ba(),function(c,e){b=[];c&&c.enablePublicMethods&&
r("enablePublicMethods option has been removed, public methods are now always available in the iFrame");switch(typeof e){case "undefined":case "string":Array.prototype.forEach.call(document.querySelectorAll(e||"iframe"),a.bind(t,c));break;case "object":a(c,e);break;default:throw new TypeError("Unexpected data type ("+typeof e+")");}return b}}function ca(a){a.fn?a.fn.iFrameResize||(a.fn.iFrameResize=function(a){return this.filter("iframe").each(function(b,c){P(c,a)}).end()}):A("info","","Unable to bind to jQuery, it is not fully loaded.",
b[""]?b[""].log:B)}if("undefined"!=typeof window){var Q=0,B=!1,E=!1,N=7,C="[iFrameSizer]",F=C.length,l=null,n=window.requestAnimationFrame,aa={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},b={},v=null,u={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,
sizeHeight:!0,sizeWidth:!1,warningTimeout:5E3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){r("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};window.jQuery&&ca(window.jQuery);"function"==typeof define&&define.amd?define([],z):"object"==typeof module&&"object"==typeof module.exports?module.exports=z():window.iFrameResize=window.iFrameResize||z()}}();